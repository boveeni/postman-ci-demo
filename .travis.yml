language: node_js
node_js: "node"

install:
- npm install newman
- yarn

before_script:
- node --version
- npm --version
- node_modules/.bin/newman --version

script:
- node ./src/index.js &
- node_modules/.bin/newman run tests/postman-demo-tests.postman_collection.json

deploy:
  provider: heroku
  api_key:
    secure: $HEROKU_API